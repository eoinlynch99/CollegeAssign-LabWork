--PART 1--
GRANT SELECT, UPDATE, DELETE, INSERT ON STORES TO ELYNCH;
GRANT SELECT, UPDATE, DELETE, INSERT ON USERUSAGE TO ELYNCH;

--PART 2A--
INSERT INTO DT2112B5.STORES VALUES(
45678,
'JD SPORTS',
'DUBLIN',
08653592
);

INSERT INTO DT2112B5.STORES VALUES(
21355,
'NOWHERE',
'CORK',
08739487
);

INSERT INTO DT2112B5.STORES VALUES(
26715,
'LIFESTYLE',
'TALLAGHT',
08987612
);

INSERT INTO DT2112B5.STORES VALUES(
43985,
'PENNYS',
'NUTGROVE',
08345892
);

INSERT INTO DT2112B5.STORES VALUES(
98563,
'DUNNES',
'DERRY',
08635389
);

INSERT INTO DT2112B5.STORES VALUES(
98563,
'DUNNES',
'DERRY',
08635389
);

INSERT INTO DT2112B5.STORES VALUES(
98563,
'SUBWAY',
'MARYST',
0831234
);

INSERT INTO DT2112B5.STORES VALUES(
76583,
'BOOJUM',
'KERRY',
0837812
);

INSERT INTO DT2112B5.STORES VALUES(
78123,
'STARPIZ',
'TYRONE',
0897654
);

INSERT INTO DT2112B5.STORES VALUES(
21765,
'VERSACE',
'KILDARE',
0856312
);

--PART 2B--
INSERT INTO DT2112B5.USERUSAGE VALUES(
12345678,
08361957,
12357232,
14135131,
15523662,
23623462,
35326435
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
23534523,
32542345,
47646145,
37435723,
23463621,
14633472,
23572723
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
23462311,
64326236,
98823632,
92992343,
15344632,
13746464,
78568568
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
47435743,
24572372,
44834854,
74745722,
45725727,
25437275,
25223727
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
99456232,
76591752,
12359159,
12351891,
23185018,
09179130,
08569208
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
97351823,
01846194,
17468191,
56913471,
49174811,
76589121,
19571911
);

INSERT INTO DT2112B5.USERUSAGE VALUES(
123450,
12395981,
67219521,
57757519,
12351515,
97568912,
86731923
);


INSERT INTO DT2112B5.USERUSAGE VALUES(
46146161,
96793571,
01935133,
05871233,
65718322,
09135712,
82571819
);

--Part 3 & prompts for user input

UPDATE DT2112B5.USERUSAGE SET  PRICE=&PRICE WHERE PRICE=57757512;

UPDATE DT2112B5.USERUSAGE SET  PRICE=&PRICE WHERE PRICE=14135131;

UPDATE DT2112B5.USERUSAGE SET  PRICE=&PRICE WHERE PRICE=37435723;

UPDATE DT2112B5.STORES SET  STORE_PHONE_NUMBER=&STORE_PHONE_NUMBER WHERE STORE_PHONE_NUMBER=66666666;

UPDATE DT2112B5.STORES SET  STORE_PHONE_NUMBER=&STORE_PHONE_NUMBER WHERE STORE_PHONE_NUMBER=66666661;

--PART 4A
SELECT CONTRACT_NUMBER, PRICE FROM DT2112B5.USERUSAGE;
SELECT STORE_ID, STORE_NAME FROM DT2112B5.STORES;

SELECT STORE_ID FROM DT2112B5.STORES WHERE STORE_PHONE_NUMBER = 5665;
SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE WHERE PRICE = 57757512;

SELECT * FROM DT2112B5.STORES WHERE STORE_ID < 3333;
SELECT * FROM DT2112B5.USERUSAGE WHERE CONTRACT_NUMBER < 5434697;

--PART 4B
SELECT * FROM DT2112B5.STORES ORDER BY STORE_PHONE_NUMBER;
SELECT * FROM DT2112B5.USERUSAGE ORDER BY CONTRACT_NUMBER;
SELECT * FROM DT2112B5.USERUSAGE ORDER BY PRICE;

--PART 4C
SELECT PRICE FROM DT2112B5.USERUSAGE WHERE PRICE IS NOT NULL;
SELECT STORE_ID FROM DT2112B5.STORES WHERE STORE_ID IS NOT NULL;

SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE WHERE CONTRACT_NUMBER IS NULL;
SELECT STORE_PHONE_NUMBER FROM DT2112B5.STORES WHERE STORE_PHONE_NUMBER IS NULL;

--PART 4D
SELECT STORE_ID, STORE_PHONE_NUMBER FROM DT2112B5.STORES GROUP BY STORE_ID, STORE_PHONE_NUMBER;
SELECT CONTRACT_ID, OVERSEAS_CALL FROM DT2112B5.STORES GROUP BY CONTRACT_ID, OVERSEAS_CALL;

SELECT STORE_ID FROM DT2112B5.STORES GROUP BY STORE_ID HAVING (STORE_ID) < 6666;
SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE GROUP BY CONTRACT_NUMBER HAVING (CONTRACT_NUMBER) < 543459;

--PART 4E
SELECT STORE_PHONE_NUMBER FROM DT2112B5.STORES UNION SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE;
SELECT STORE_PHONE_NUMBER FROM DT2112B5.STORES MINUS SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE;
SELECT CONTRACT_NUMBER FROM DT2112B5.CONTRACT INTERSECT SELECT CONTRACT_NUMBER FROM DT2112B5.USERUSAGE